<div class="toolbar-container">
    <!-- Mode Selector -->
    <section class="toolbar-section">
        <h3 class="section-title">Tools</h3>
        <div class="mode-grid">
            <cb-brutal-button (clicked)="setMode('select')" [variant]="mode() === 'select' ? 'primary' : 'ghost'"
                size="sm" icon="ðŸ–±ï¸">
                Select
            </cb-brutal-button>

            <cb-brutal-button (clicked)="setMode('connect')" [variant]="mode() === 'connect' ? 'primary' : 'ghost'"
                size="sm" icon="ðŸ”—">
                Connect
            </cb-brutal-button>

            <cb-brutal-button (clicked)="setMode('hypothesis')"
                [variant]="mode() === 'hypothesis' ? 'primary' : 'ghost'" size="sm" icon="ðŸ’¡">
                Hypothesis
            </cb-brutal-button>

            <cb-brutal-button (clicked)="setMode('pan')" [variant]="mode() === 'pan' ? 'primary' : 'ghost'" size="sm"
                icon="ðŸ‘†">
                Pan
            </cb-brutal-button>
        </div>
    </section>

    <!-- View Controls -->
    <section class="toolbar-section">
        <h3 class="section-title">View</h3>
        <div class="control-group">
            <div class="control-row">
                <span class="control-label">Zoom: {{ (viewport().zoom * 100) | number:'1.0-0' }}%</span>
                <div class="zoom-buttons">
                    <cb-brutal-button (clicked)="zoom(-0.1)" size="sm" variant="ghost">-</cb-brutal-button>
                    <cb-brutal-button (clicked)="resetViewport()" size="sm" variant="ghost">Reset</cb-brutal-button>
                    <cb-brutal-button (clicked)="zoom(0.1)" size="sm" variant="ghost">+</cb-brutal-button>
                </div>
            </div>

            <div class="control-row">
                <span class="control-label">Grid</span>
                <label class="toggle">
                    <input type="checkbox" [checked]="tools().isGridVisible" (change)="toggleGrid()">
                    <span class="slider"></span>
                </label>
            </div>

            <div *ngIf="tools().isGridVisible" class="sub-controls">
                <div class="control-row">
                    <span class="control-label small">Snap to Grid</span>
                    <label class="toggle small">
                        <input type="checkbox" [checked]="tools().isSnapToGrid" (change)="toggleSnapToGrid()">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="slider-control">
                    <label class="control-label small">Grid Size: {{ tools().gridSize }}px</label>
                    <input type="range" min="10" max="50" step="5" [value]="tools().gridSize"
                        (input)="updateGridSize($event)" class="range-slider">
                </div>
            </div>
        </div>
    </section>

    <!-- Connection Style -->
    <section class="toolbar-section">
        <h3 class="section-title">Connections</h3>
        <div class="control-group">
            <div class="control-row">
                <span class="control-label">Style</span>
                <select [value]="tools().connectionStyle" (change)="updateConnectionStyle($event)" class="style-select">
                    <option value="straight">Straight</option>
                    <option value="bezier">Curved</option>
                    <option value="orthogonal">Orthogonal</option>
                </select>
            </div>

            <div class="control-row">
                <span class="control-label">Show Labels</span>
                <label class="toggle small">
                    <input type="checkbox" [checked]="tools().showLabels" (change)="toggleLabels()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </section>

    <!-- Actions -->
    <section class="toolbar-section">
        <h3 class="section-title">Actions</h3>
        <div class="action-buttons">
            <cb-brutal-button (clicked)="saveLayout()" variant="secondary" size="sm" icon="ðŸ’¾" [disabled]="!canSave()">
                Save Layout
            </cb-brutal-button>

            <div class="button-row">
                <cb-brutal-button (clicked)="undo()" variant="ghost" size="sm" icon="â†¶" [disabled]="!canUndo()">
                    Undo
                </cb-brutal-button>

                <cb-brutal-button (clicked)="redo()" variant="ghost" size="sm" icon="â†·" [disabled]="!canRedo()">
                    Redo
                </cb-brutal-button>
            </div>

            <cb-brutal-button (clicked)="autoArrange()" variant="ghost" size="sm" icon="ðŸ”€">
                Auto Arrange
            </cb-brutal-button>
        </div>
    </section>

    <!-- Stats -->
    <section class="toolbar-section">
        <cb-glass-card [blur]="true" additionalClasses="stats-card">
            <h3 class="section-title">Board Stats</h3>
            <div class="stats-grid">
                <div class="stat-row">
                    <span class="stat-label">Nodes:</span>
                    <span class="stat-value">{{ nodes().length }}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Connections:</span>
                    <span class="stat-value">{{ connections().length }}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Selected:</span>
                    <span class="stat-value">{{ selectedNode() ? '1 node' : 'None' }}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Mode:</span>
                    <span class="stat-value">{{ mode() | titlecase }}</span>
                </div>
            </div>
        </cb-glass-card>
    </section>
</div>